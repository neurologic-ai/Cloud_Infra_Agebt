
{
  "inventory_adapters": {
    "aws": {"resources": [
      {"cloud": "aws", "id": "i-0a1b2c", "kind": "vm", "region": "us-east-1", "tags": {"env": "prod", "owner": "ml-team", "cost-center": "CC101", "service": "fraud"}}
    ]},
    "azure": {"resources": [
      {"cloud": "azure", "id": "/subs/xxx/rg/prod-vmss1/instance/2", "kind": "vm", "region": "eastus", "tags": {"env": "prod", "owner": "web", "service": "portal"}}
    ]},
    "gcp": {"resources": [
      {"cloud": "gcp", "id": "projects/p1/zones/us-central1-a/instances/inst-1", "kind": "vm", "region": "us-central1", "tags": {"env": "dev", "owner": "data"}}
    ]}
  },
  "resources": [
    {"cloud": "aws", "id": "i-0a1b2c", "kind": "vm", "region": "us-east-1", "tags": {"env": "prod", "owner": "ml-team", "cost-center": "CC101", "service": "fraud"}},
    {"cloud": "azure", "id": "/subs/xxx/rg/prod-vmss1/instance/2", "kind": "vm", "region": "eastus", "tags": {"env": "prod", "owner": "web", "service": "portal"}},
    {"cloud": "gcp", "id": "projects/p1/zones/us-central1-a/instances/inst-1", "kind": "vm", "region": "us-central1", "tags": {"env": "dev", "owner": "data"}}
  ],
  "compute_instances": [
    {"id": "i-0a1b2c", "cpu_p95": 0.22, "mem_p95": 0.18, "low_util_hours_30d": 180},
    {"id": "vmss-2", "cpu_p95": 0.61, "mem_p95": 0.54, "low_util_hours_30d": 12},
    {"id": "gce-inst-1", "cpu_p95": 0.09, "mem_p95": 0.08, "low_util_hours_30d": 210}
  ],
  "k8s_rows": {
    "nodes": {"cpu_p95": 0.71, "mem_p95": 0.65},
    "pods": {"cpu_req_vs_used": 0.58, "mem_req_vs_used": 0.62},
    "binpack_efficiency": 0.74,
    "pending_pods_p95": 3
  },
  "ts_metrics": [
    {"ts": "2025-08-10T12:00:00Z", "target_cpu": 0.6, "actual_cpu": 0.82},
    {"ts": "2025-08-10T12:03:00Z", "target_cpu": 0.6, "actual_cpu": 0.65}
  ],
  "scale_events": [
    {"ts": "2025-08-10T12:02:00Z", "action": "scale_out", "delta": 2, "resource": "asg/app-prod"}
  ],
  "db_metrics": [
    {"id": "rds-a", "engine": "postgres", "cpu_p95": 0.52, "connections_p95": 0.61, "storage_iops_p95": 0.39},
    {"id": "azure-sql-1", "engine": "mssql", "cpu_p95": 0.12, "connections_p95": 0.18, "storage_iops_p95": 0.11}
  ],
  "lb_metrics": [
    {"id": "alb-1", "lat_p50": 42, "lat_p95": 130, "lat_p99": 260, "r4xx": 0.018, "r5xx": 0.003, "unhealthy_minutes": 10},
    {"id": "appgw-1", "lat_p50": 55, "lat_p95": 150, "lat_p99": 280, "r4xx": 0.012, "r5xx": 0.004, "unhealthy_minutes": 4}
  ],
  "block_volumes": [
    {"id": "vol-1", "cloud": "aws", "size_gb": 500, "attached": false},
    {"id": "disk-2", "cloud": "azure", "size_gb": 256, "attached": true}
  ],
  "snapshots": [
    {"id": "snap-1", "cloud": "aws", "source_volume": null},
    {"id": "snap-2", "cloud": "gcp", "source_volume": "pd-3"}
  ],
  "objects": [
    {"bucket": "ml-prod", "key": "logs/2025/05/01.gz", "size": 10485760, "storage_class": "STANDARD", "last_modified": "2025-05-01T00:00:00Z"},
    {"bucket": "ml-prod", "key": "archive/2024/01/01.parquet", "size": 52428800, "storage_class": "STANDARD", "last_modified": "2024-01-01T00:00:00Z"}
  ],
  "lifecycle_rules": [
    {"bucket": "ml-prod", "rule_id": "move-cold-90d", "transition_after_days": 90, "to_class": "GLACIER/COOL/NEARLINE"}
  ],
  "iac_index": {
    "i-0a1b2c": true,
    "alb-1": false,
    "rds-a": true
  },
  "policy_findings": [
    {"id": "POL-001", "control": "no_public_ip_vm", "severity": "high", "resource_id": "i-9zzz", "status": "noncompliant"},
    {"id": "POL-002", "control": "nsg_no_any_any", "severity": "critical", "resource_id": "nsg-123", "status": "noncompliant"}
  ],
  "incidents": [
    {"id": "PD-abc", "sev": 1, "opened": "2025-08-10T09:00:00Z", "resolved": "2025-08-10T10:05:00Z", "source": "pagerduty", "service": "fraud-api"},
    {"id": "OPS-1234", "sev": 2, "opened": "2025-08-05T13:15:00Z", "resolved": "2025-08-05T15:00:00Z", "source": "jira", "service": "portal"},
    {"id": "INC0010001", "sev": 2, "opened": "2025-08-01T08:55:00Z", "resolved": "2025-08-01T09:20:00Z", "source": "servicenow", "service": "batch-jobs"}
  ],
  "slo_breaches": [
    {"service": "fraud-api", "hours": 2.4, "window_start": "2025-08-02T00:00:00Z", "window_end": "2025-08-09T00:00:00Z"}
  ],
  "cost_rows": [
    {"cloud": "aws", "service": "EC2", "resource_id": "i-0a1b2c", "cost": 123.45, "month": "2025-07", "tags": {"env": "prod", "owner": "ml-team"}, "env":"prod","owner":"ml-team"},
    {"cloud": "azure", "service": "VM", "resource_id": "/subs/xxx/rg/prod-vmss1/instance/2", "cost": 67.80, "month": "2025-07", "tags": {"env": "prod"}, "env":"prod","owner":"web"},
    {"cloud": "gcp", "service": "GCE", "resource_id": "projects/p1/instances/inst-1", "cost": 42.10, "month": "2025-07", "tags": {}, "env":"dev","owner":"data"}
  ],
  "commit_inventory": [
    {"cloud": "aws", "type": "savings_plan", "family": "compute", "term_months": 12, "commit_usd_hour": 2.00, "start": "2025-04-01"},
    {"cloud": "gcp", "type": "cud", "family": "n1-standard", "term_months": 12, "commit_usd_hour": 1.50, "start": "2025-01-01"}
  ],
  "usage": [
    {"cloud": "aws", "family": "compute", "used_usd_hour": 1.80, "hours": 720},
    {"cloud": "gcp", "family": "n1-standard", "used_usd_hour": 1.10, "hours": 720}
  ],
  "rightsizing": [
    {"resource_id": "i-0a1b2c", "current": "m5.large", "recommended": "t3.medium", "monthly_savings": 42.30, "reason": "low utilization"},
    {"resource_id": "sql-azure-1", "current": "GP_Gen5_8", "recommended": "GP_Gen5_4", "monthly_savings": 87.10, "reason": "CPU < 15%"}
  ],
  "egress_costs": [
    {"type": "inter_region", "usd": 942.30},
    {"type": "internet", "usd": 3210.50}
  ],
  "net_metrics": [
    {"ts": "2025-08-10T12:00:00Z", "egress_gb": 120.0},
    {"ts": "2025-08-10T13:00:00Z", "egress_gb": 570.0}
  ],
  "network_policies": [
    {"id": "sg-1", "cloud": "aws", "rule": "0.0.0.0/0:22", "resource_id": "i-9zzz"},
    {"id": "nsg-123", "cloud": "azure", "rule": "Any/Any", "resource_id": "vm-prod-1"}
  ],
  "storage_acls": [
    {"bucket": "ml-prod", "cloud": "aws", "public": true},
    {"bucket": "portal-assets", "cloud": "gcp", "public": false}
  ],
  "security_resources_crypto_tls": [
    {"id": "vol-1", "type": "block_volume", "encrypted_at_rest": true},
    {"id": "alb-1", "type": "load_balancer", "tls_policy": "TLS1.2-2019-Modern"}
  ],
  "iam_dump": {
    "users": [
      {"name": "alice", "mfa_enabled": true},
      {"name": "bob", "mfa_enabled": false}
    ],
    "keys": [
      {"user": "alice", "age_days": 22},
      {"user": "service-user", "age_days": 190}
    ],
    "policies": [
      {"principal": "admin-group", "effect": "Allow", "actions": ["*"], "resources": ["*"]}
    ]
  },
  "vuln_findings": [
    {"id": "CVE-2025-0001", "severity": "CRITICAL", "resource_id": "i-0a1b2c", "resolved": false},
    {"id": "CVE-2024-9999", "severity": "HIGH", "resource_id": "vmss-2", "resolved": true}
  ],
  "patch_status": {
    "agent_coverage_pct": 0.91,
    "avg_patch_age_days": 19
  },
  "cspm_findings": [
    {"id": "S3.1", "severity": "HIGH", "resource_id": "ml-prod", "opened_at": "2025-07-01"},
    {"id": "NET.0", "severity": "CRITICAL", "resource_id": "nsg-123", "opened_at": "2025-06-15"}
  ],
  "kms_keys": [
    {"id": "key-1", "rotation_enabled": true},
    {"id": "key-legacy", "rotation_enabled": false}
  ],
  "secrets": [
    {"name": "db-password", "age_days": 45},
    {"name": "api-token", "age_days": 180}
  ],
  "gpu_metrics": [
    {"ts": "2025-08-10T12:00:00Z", "gpu_util": 0.72},
    {"ts": "2025-08-10T13:00:00Z", "gpu_util": 0.54}
  ],
  "gpu_cost_rows": [
    {"cloud": "aws", "resource_id": "g5xlarge-node-1", "usd_per_hour": 1.006, "hours": 30}
  ],
  "iac_runs": [
    {"id": "tf-101", "created": "2025-08-07T09:00:00Z", "merged": "2025-08-07T16:00:00Z", "status": "applied"},
    {"id": "tf-102", "created": "2025-08-09T10:00:00Z", "merged": "2025-08-10T11:00:00Z", "status": "applied"}
  ]
}
